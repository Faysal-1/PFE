<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ajouter un hébergement</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="/SuperAdmin/css/sidebar.css">
  <style>
    /* Style pour le texte "Non connecté" */
    .non-connecte {
      background-color: #4a7aff;
      color: white;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 11px;
    }
    
    /* Style personnalisé pour l'affichage du rôle utilisateur */
    .user-info {
      margin-left: 10px;
      flex-grow: 1;
      max-width: 160px;
    }
    
    .user-name {
      font-size: 14px;
      font-weight: 600;
      color: #333;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    .user-role {
      font-size: 12px;
      color: #6c757d;
      text-transform: none;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    
    /* Variables CSS pour la cohérence des couleurs */
    :root {
      --sidebar-width: 296px;
      --primary-color: #0056b3;
      --secondary-color: #4f8cff;
      --accent-color: #ffb347;
      --text-color: #2c3e50;
      --light-text: #6c7a89;
      --border-color: #e0e6ed;
      --background-color: #f5f7fa;
      --card-bg: #ffffff;
      --success-color: #2ecc71;
      --error-color: #e74c3c;
      --shadow: 0 4px 12px rgba(0,0,0,0.08);
      --transition: all 0.3s ease;
    }
    
    /* Styles pour la barre latérale */
    .dashboard__sidebar {
      width: var(--sidebar-width);
      flex-shrink: 0;
      position: fixed;
      top: 0;
      left: 0;
      overflow-y: auto;
      height: 100vh;
      z-index: 5;
      box-shadow: 0 0 15px rgba(0,0,0,0.05);
      transition: all 0.3s ease;
    }
    
    .dashboard__main {
      flex-grow: 1;
      padding-left: var(--sidebar-width);
      min-height: 100vh;
      background: var(--background-color);
      position: relative;
      width: calc(100% - var(--sidebar-width));
    }
    
    /* Styles pour la barre latérale en mode responsive */
    @media (max-width: 992px) {
      .dashboard__container {
        flex-direction: column;
      }
      
      .dashboard__sidebar {
        width: 100%;
        height: auto;
        position: relative;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      }
      
      .dashboard__main {
        padding-left: 0 !important;
        width: 100% !important;
      }
      
      .form-container {
        position: relative !important;
        left: 0 !important;
        width: 90% !important;
        height: auto !important;
        margin: 20px auto !important;
      }
    }
    
    .sidebar-header {
      padding: 15px;
      display: flex;
      flex-direction: column;
    }
    
    .logo-container {
      display: flex;
      align-items: center;
      margin-bottom: 15px;
    }
    
    .sidebar-logo {
      width: 40px;
      height: 40px;
      object-fit: contain;
      margin-right: 10px;
    }
    
    .sidebar-title {
      font-size: 18px;
      font-weight: 600;
      color: var(--primary-color);
      margin: 0;
    }
    
    
    .user-profile {
      display: flex;
      align-items: center;
      padding: 10px 0;
    }
    
    .user-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 10px;
      border: 2px solid var(--border-color);
    }
    
    .user-name {
      font-size: 14px;
      font-weight: 500;
      color: var(--text-color);
    }
    
    .sidebar-divider {
      height: 1px;
      background-color: var(--border-color);
      margin: 10px 0;
    }
    
    .sidebar__item {
      margin-bottom: 5px;
    }
    
    .sidebar__button {
      padding: 12px 20px;
      border-radius: 8px;
      transition: var(--transition);
      margin: 0 8px;
    }
    
    .sidebar__button:hover, 
    .sidebar__button.-is-active {
      background-color: rgba(0, 86, 179, 0.08);
    }
    
    .sidebar__button.-is-active a {
      color: var(--primary-color);
      font-weight: 600;
    }
    
    .sidebar__button a {
      color: var(--text-color);
      text-decoration: none;
      width: 100%;
      display: flex;
      align-items: center;
    }
    
    .sidebar__button i {
      font-size: 18px;
      width: 24px;
      color: var(--primary-color);
    }
    
    /* Styles pour les éléments de la barre latérale */
    .mr-15 {
      margin-right: 15px;
    }
    
    .ml-auto {
      margin-left: auto;
    }
    
    .d-flex {
      display: flex;
    }
    
    .items-center {
      align-items: center;
    }
    
    .text-14 {
      font-size: 14px;
    }
    
    .text-15 {
      font-size: 15px;
    }
    
    .lh-1 {
      line-height: 1;
    }
    
    .fw-400 {
      font-weight: 400;
    }
    
    .fw-500 {
      font-weight: 500;
    }
    
    .sidebar-submenu-container {
      padding-left: 15px;
      margin-bottom: 10px;
    }
    
    .sidebar-submenu {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .submenu-item {
      margin-bottom: 2px;
    }
    
    .submenu-item.active .submenu-link {
      color: var(--primary-color);
      font-weight: 500;
    }
    
    .submenu-link {
      display: flex;
      align-items: center;
      padding: 8px 10px;
      border-radius: 6px;
      text-decoration: none;
      color: #555;
      transition: var(--transition);
    }
    
    .submenu-link:hover {
      background-color: rgba(0, 102, 204, 0.05);
      color: var(--primary-color);
    }
    
    .submenu-icon {
      margin-right: 8px;
      font-size: 14px;
    }
    
    .logout-button {
      margin-top: 20px;
    }
    
    .logout-button a {
      color: #e74c3c;
    }
    
    .logout-button i {
      color: #e74c3c;
    }
    
    .logout-button:hover {
      background-color: rgba(231, 76, 60, 0.08);
    }
    
    body {
      font-family: 'Roboto', Arial, sans-serif;
      background: var(--background-color);
      margin: 0;
      padding: 0;
      color: var(--text-color);
    }
    .form-container {
      max-width: 800px;
      margin: 30px auto;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 32px 40px 24px 40px;
      position: relative;
      overflow: hidden;
      width: 90%;
    }
    
    .form-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
    }
    .step {
      display: none;
      animation: fadeIn .4s;
    }
    .step.active {
      display: block;
    }
    .section-title {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 25px;
      letter-spacing: 1px;
    }
    
    .form-section {
      margin-bottom: 30px;
      padding: 20px;
      background-color: #f9f9f9;
      border-radius: 8px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
    }
    .form-group {
      margin-bottom: 22px;
      position: relative;
      width: 100%;
    }
    label {
      font-weight: 600;
      color: var(--text-color);
      margin-bottom: 8px;
      display: block;
      font-size: 1rem;
      transition: var(--transition);
    }
    input, select, textarea {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 1rem;
      background: #fafbfc;
      margin-top: 8px;
      margin-bottom: 8px;
      transition: var(--transition);
      color: var(--text-color);
      box-sizing: border-box;
      display: block;
    }
    input:focus, select:focus, textarea:focus {
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 0 3px rgba(0, 86, 179, 0.15);
      background: #fff;
    }
    .pagination {
      margin-top: 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .pagination .btn {
      background: var(--primary-color);
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 12px 28px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0, 86, 179, 0.15);
      transition: var(--transition);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    .pagination .btn:hover {
      background: #0062cc;
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0, 86, 179, 0.25);
    }
    .dropzone {
      border: 2px dashed var(--primary-color);
      border-radius: 10px;
      background: rgba(0, 86, 179, 0.05);
      text-align: center;
      padding: 34px 0;
      margin-top: 10px;
      margin-bottom: 10px;
      color: var(--primary-color);
      transition: var(--transition);
      cursor: pointer;
      position: relative;
    }
    .dropzone.dragover {
      border-color: var(--secondary-color);
      background: rgba(79, 140, 255, 0.1);
    }
    .dropzone input[type="file"] {
      display: none;
    }
    .dropzone .icon {
      font-size: 2.3rem;
      margin-bottom: 7px;
      display: block;
    }
    .preview-img {
      max-width: 100px;
      max-height: 100px;
      border-radius: 8px;
      margin-top: 10px;
      box-shadow: 0 2px 8px rgba(60,60,120,0.10);
    }
    @media (max-width: 600px) {
      .form-container {
        padding: 16px 6px;
      }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    body {
      background: #f6f8fb;
      font-family: 'Segoe UI', Arial, sans-serif;
      margin: 0;
      padding: 0;
    }
    
    .form-container {
      background-color: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 0 20px rgba(0,0,0,0.1);
    }

    /* Styles pour l'aperçu des détails */
    .preview-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-top: 20px;
    }

    .preview-image {
      text-align: center;
    }

    .preview-image img {
      max-height: 300px;
      object-fit: cover;
    }

    .preview-info {
      background: var(--background-color);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .preview-info h3 {
      color: var(--primary-color);
      margin-bottom: 15px;
    }

    .type {
      font-size: 1.1rem;
      color: var(--secondary-color);
      margin-bottom: 20px;
    }

    .details-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .detail-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background: white;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }

    .detail-item .label {
      font-weight: 600;
      color: var(--text-color);
    }

    .detail-item .value {
      color: var(--primary-color);
    }

    .description-preview {
      background: white;
      padding: 15px;
      border-radius: 6px;
      box-shadow: 0 1px 4px rgba(0,0,0,0.05);
    }

    .description-preview h4 {
      margin: 0 0 10px 0;
      color: var(--primary-color);
    }

    .description-preview p {
      margin: 0;
      line-height: 1.6;
      color: var(--text-color);
    }

    /* Styles pour le formulaire */
    .form-section {
      display: none;
      margin-bottom: 20px;
    }

    .form-section.active {
      display: block;
    }

    .form-header {
      margin-bottom: 20px;
    }

    .form-header h2 {
      color: var(--primary-color);
      margin-bottom: 10px;
    }

    .form-content {
      background: var(--background-color);
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    /* Styles pour les chambres */
    .chambres-container {
      margin-bottom: 20px;
    }

    .chambre-form {
      background: var(--background-color);
      border-radius: 8px;
      margin-bottom: 15px;
      padding: 15px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .chambre-header {
      margin-bottom: 10px;
      border-bottom: 1px solid #e0e0e0;
      padding-bottom: 10px;
    }

    .chambre-header h4 {
      margin: 0;
      color: var(--primary-color);
    }

    .chambre-content {
      margin: 15px 0;
    }

    .chambre-actions {
      margin-top: 10px;
      text-align: right;
    }

    .btn-remove-chambre {
      padding: 8px 15px;
      background-color: #dc3545;
      border: none;
      color: white;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-remove-chambre:hover {
      background-color: #c82333;
    }

    .btn-remove-chambre i {
      margin-right: 5px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-color);
      font-weight: 600;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #e0e6ed;
      border-radius: 6px;
      font-size: 1rem;
    }

    .form-navigation {
      display: flex;
      justify-content: flex-end;
      margin-top: 20px;
      gap: 10px;
    }

    .form-navigation-center {
      display: flex;
      justify-content: center;
      margin-top: 20px;
      gap: 10px;
    }

    .btn-next,
    .btn-prev,
    .btn-save {
      padding: 12px 25px;
      border-radius: 8px;
      border: none;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-next {
      background-color: var(--primary-color);
      color: white;
    }

    .btn-prev {
      background-color: var(--secondary-color);
      color: white;
    }

    .btn-save {
      background-color: #4CAF50;
      color: white;
    }
    
    
    .form-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--primary-color);
      margin-bottom: 15px;
      text-align: center;
      border-bottom: 2px solid var(--border-color);
      padding-bottom: 10px;
    }
    
    .section-title {
      color: var(--primary-color);
      margin-bottom: 12px;
      font-size: 20px;
      border-left: 4px solid var(--primary-color);
      padding-left: 10px;
    }
    
    .form-section {
  display: none;
}
.form-section.active {
  display: block;
}

    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .form-navigation {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      padding-top: 10px;
      border-top: 1px solid var(--border-color);
      padding: 10px 0;
    }
    
    .form-navigation-center {
      display: flex;
      justify-content: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid var(--border-color);
      padding: 20px 0;
    }
    
    .btn-next, .btn-prev, .btn-save {
      min-width: 140px;
      font-weight: 600;
      padding: 12px 20px;
      border-radius: 8px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .btn-next {
      background-color: var(--primary-color);
    }
    
    .btn-next:hover {
      background-color: #0062cc;
      transform: translateY(-2px);
      box-shadow: 0 6px 8px rgba(0,0,0,0.15);
    }
    
    .btn-prev {
      background-color: #6c757d;
    }
    
    .btn-prev:hover {
      background-color: #5a6268;
      transform: translateY(-2px);
      box-shadow: 0 6px 8px rgba(0,0,0,0.15);
    }
    
    .btn-save {
      background-color: var(--success-color);
    }
    
    .btn-save:hover {
      background-color: #27ae60;
      transform: translateY(-2px);
      box-shadow: 0 6px 8px rgba(0,0,0,0.15);
    }
    
    .form-group {
      margin-bottom: 12px;
    }
    
    label {
      font-weight: 500;
      color: var(--text-color);
      margin-bottom: 8px;
      display: block;
    }
    
    input[type="text"],
    input[type="number"],
    input[type="date"],
    textarea,
    select {
      width: 100%;
      padding: 10px 12px;
      border-radius: 7px;
      border: 1px solid var(--border-color);
      background: #f9fafc;
      font-size: 1rem;
      color: var(--text-color);
      transition: var(--transition);
    }
    
    .custom-file-input {
      position: relative;
      cursor: pointer;
      border: 2px dashed var(--border-color);
      padding: 20px;
      text-align: center;
      border-radius: 8px;
      background-color: rgba(0, 86, 179, 0.05);
      color: var(--text-color);
      transition: var(--transition);
    }
    
    .custom-file-input input[type="file"] {
      position: absolute;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }
    
    .preview-img {
      max-width: 200px;
      border-radius: 8px;
      margin-top: 15px;
      border: 1px solid var(--border-color);
    }
    
    .btn {
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 7px;
      padding: 10px 20px;
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition);
    }
  </style>
</head>
<body sec:authorize="hasAnyAuthority('PROPRIETAIRE_PRIVILEGE', 'SUPERADMIN_PRIVILEGE')" style="margin: 0; padding: 0;">
  <!-- Message d'accès refusé pour les utilisateurs sans autorisation -->
  <div sec:authorize="!hasAnyAuthority('PROPRIETAIRE_PRIVILEGE', 'SUPERADMIN_PRIVILEGE')" style="text-align: center; margin-top: 100px;">
    <h2 class="error-message">Accès refusé</h2>
    <p class="error-description">Seuls les propriétaires et les administrateurs peuvent gérer les hébergements.</p>
    <a href="/admin/hebergements" class="error-link"><i class="fas fa-arrow-left"></i> Retour à la liste des hébergements</a>
  </div>
  <div class="dashboard__container">
    <!-- Barre latérale -->  
    <div class="sidebar-container">
      <div class="sidebar-header">
        <div class="logo-container">
          <div id="header_menu">
            <img src="/assets/img/logo_sticky.png" width="160" height="34" alt="City tours">
          </div>
        </div>
        <span class="sidebar-title">Administration</span>
        <div class="user-profile">
          <a th:href="@{/SuperAdmin/profile}" class="profile-link">
            <img th:src="${userProfileImage}" alt="User Avatar" class="user-avatar" onerror="this.src='/assets/img/tourist_guide_pic.jpg';">
            <div class="user-info">
              <div class="user-name" th:text="${#authentication != null && #authentication.principal != null ? #authentication.principal.firstName + ' ' + #authentication.principal.lastName : 'Utilisateur'}">superAdmin</div>
              <div class="user-role" th:text="${#authentication != null && #authentication.principal != null && not #lists.isEmpty(#authentication.principal.roles) ? #authentication.principal.roles[0].name : 'Non connecté'}">ROLE</div>
            </div>
          </a>
          <div class="notification-bell" title="Notifications">
            <i class="fas fa-bell"></i>
            <span class="notification-badge" id="notificationBadge">0</span>
          </div>
        </div>
      </div>
      
      <div class="sidebar-menu">
        <a th:href="@{/hebergement/wishlist}" class="menu-item">
          <i class="fas fa-heart"></i>
          <span>Liste de souhaits</span>
        </a>
        <a href="/admin/index" class="menu-item">
          <i class="fas fa-th-large"></i>
          <span>Tableau de bord</span>
        </a>
        
        <div class="menu-item dropdown" th:if="${isHebergementAdmin != null && isHebergementAdmin} or ${isProprietaire != null && isProprietaire} or ${isSuperAdmin != null && isSuperAdmin}" sec:authorize="hasAnyAuthority('SUPERADMIN_PRIVILEGE', 'HEBERGEMENT_ADMIN_PRIVILEGE', 'PROPRIETAIRE_PRIVILEGE')">
          <div class="menu-header" onclick="toggleSubmenu(this)">
            <div class="menu-icon-title">
              <i class="fas fa-building"></i>
              <span>Gérer les hébergements</span>
            </div>
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="submenu">
  <!-- SuperAdmin et HebergementAdmin : Tous les hébergements -->
  <a href="/admin/hebergements" class="submenu-item" th:if="${isSuperAdmin != null && isSuperAdmin} or (${isHebergementAdmin != null && isHebergementAdmin})">
    <i class="fas fa-list-ul"></i>
    <span>Tous les hébergements</span>
  </a>
  <!-- Propriétaire : Mes hébergements -->
  <a href="/admin/hebergements" class="submenu-item" th:if="${isProprietaire != null && isProprietaire && !isHebergementAdmin && !isSuperAdmin}">
    <i class="fas fa-list-ul"></i>
    <span>Mes hébergements</span>
  </a>
  <!-- Propriétaire et SuperAdmin : Ajouter un hébergement -->
  <a href="/admin/hebergements/add" class="submenu-item active" th:if="${isProprietaire != null && isProprietaire && !isHebergementAdmin && !isSuperAdmin} or (${isSuperAdmin != null && isSuperAdmin})">
    <i class="fas fa-plus-circle"></i>
    <span>Ajouter un hébergement</span>
  </a>
</div>
          </div>
        </div>
        
        <div class="menu-item dropdown" th:if="${isEvenementAdmin != null && isEvenementAdmin} or ${isSuperAdmin != null && isSuperAdmin}" sec:authorize="hasAnyAuthority('SUPERADMIN_PRIVILEGE', 'EVENEMENT_ADMIN_PRIVILEGE')">
          <div class="menu-header" onclick="toggleSubmenu(this)">
            <div class="menu-icon-title">
              <i class="fas fa-calendar-alt"></i>
              <span>Gérer les événements</span>
            </div>
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="submenu">
            <a href="/admin/evenements" class="submenu-item">
              <i class="fas fa-list-ul"></i>
              <span>Tous les événements</span>
            </a>
            <a href="/admin/add-evenement" class="submenu-item">
              <i class="fas fa-plus-circle"></i>
              <span>Ajouter un événement</span>
            </a>
          </div>
        </div>
        
        <div class="menu-item dropdown" th:if="${isSuperAdmin != null && isSuperAdmin}" sec:authorize="hasAuthority('SUPERADMIN_PRIVILEGE')">
          <div class="menu-header" onclick="toggleSubmenu(this)">
            <div class="menu-icon-title">
              <i class="fas fa-users"></i>
              <span>Gérer les utilisateurs</span>
            </div>
            <i class="fas fa-chevron-down"></i>
          </div>
          <div class="submenu">
            <a href="/SuperAdmin/db-vendor-user" class="submenu-item">
              <i class="fas fa-list-ul"></i>
              <span>Tous les utilisateurs</span>
            </a>
            <a href="/SuperAdmin/db-vendor-add-user" class="submenu-item">
              <i class="fas fa-user-plus"></i>
              <span>Ajouter un utilisateur</span>
            </a>
          </div>
        </div>
        
        <a th:href="@{/logout}" class="menu-item logout">
          <i class="fas fa-sign-out-alt"></i>
          <span>Déconnexion</span>
        </a>
      </div>

    <div class="dashboard__main">
  <div style="max-width:100%; margin:40px auto 0 auto; background:#fff; box-shadow:0 4px 18px rgba(0,0,0,0.11); border-radius:14px; padding:40px 32px;margin-left: -119px !important;">
    <div style="position: relative; width: 100%; min-height: 80vh; padding: 25px; z-index: 10; background-color: white; border-radius: 8px; box-shadow: 0 0 20px rgba(0,0,0,0.1); overflow-y: auto; margin-left: -22px !important;">
      <h2 class="form-title" style="text-align:center; font-size:2.2rem; color:#0066cc; font-weight:700; letter-spacing:1px; margin-bottom:32px; padding-bottom:18px; border-bottom:2px solid #eaeaea;" th:text="${isEditing != null && isEditing ? 'Modifier un hébergement' : 'Ajouter un hébergement'}">Ajouter un hébergement</h2>
      <!-- Message d'information sur la validation pour les propriétaires -->
          <form th:action="${isEditing != null && isEditing ? '/admin/hebergements/update-with-image' : '/admin/hebergements/add'}" th:object="${hebergement}" method="post" enctype="multipart/form-data" id="hebergementForm">
            <!-- Champ caché pour l'ID en mode édition -->
            <input type="hidden" th:if="${isEditing != null && isEditing}" th:field="*{id}" />
                    <!-- Section 1 - Informations générales -->
                    <div id="section1" class="form-section active">
                        <h3 class="section-title">Informations générales</h3>
                        <div class="form-group">
                            <label>Nom de l'hébergement</label>
                            <input type="text" th:field="*{nom}" required placeholder="Entrez le nom de l'hébergement">
                        </div>
                        <div class="form-group">
                          <label>Type d'hébergement</label>
                             <select th:field="*{hebergementType}" required>
                              <option value="">Sélectionner</option>
                              <option th:each="hebergementType : ${hebergementTypes}" th:value="${hebergementType}" th:text="${hebergementType}"></option>
                          </select>
                      </div>
                        <div class="form-group">
                            <label>Description</label>
                            <textarea th:field="*{description}" rows="3" required placeholder="Décrivez l'hébergement en détail"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Nombre d'étoiles</label>
                            <input type="number" step="0.5" th:field="*{nbEtoiles}" min="0" max="5" placeholder="Entre 0 et 5 étoiles">
                        </div>
                        <div style="margin-bottom: 14px; display: flex; align-items: center; gap: 8px;">
    <input type="checkbox" th:field="*{populaire}" style="width: 18px; height: 18px; accent-color: #4a7aff;" />
    <label style="margin: 0; font-weight: 600; font-size: 15px; color: #2c3e50;">
        Populaire
    </label>
</div>
<div style="margin-bottom: 14px; display: flex; align-items: center; gap: 8px;">
    <input type="checkbox" th:field="*{actif}" style="width: 18px; height: 18px; accent-color: #4a7aff;" />
    <label style="margin: 0; font-weight: 600; font-size: 15px; color: #2c3e50;">
        Actif
    </label>
</div>
                        <div class="form-group image-upload-group">
                            <label for="imageFileInput">Photo de l'hébergement</label>
                            <div class="custom-file-input">
                                <input type="file" name="imageFile" id="imageFileInput" accept="image/png, image/jpeg, image/jpg" onchange="previewImage(event)">
                                <span><i class="fas fa-upload" style="margin-right: 8px;"></i>Choisissez une image</span>
                            </div>
                           <img id="imagePreview" class="preview-img" 
                                th:src="${isEditing != null && isEditing && hebergement.photoUrl != null ? hebergement.photoUrl : '#'}" 
                                alt="Aperçu" 
                                 th:style="${isEditing != null && isEditing && hebergement.photoUrl != null ? 'display: block;' : 'display: none;'}" 
                                onerror="this.src='/assets/img/hotel_1.jpg';" />
                         </div>
                        
                        <div class="form-navigation-center" style="margin-top: 30px; text-align: center;">
                            <button type="button" class="btn btn-next" onclick="showSection(2)" style="background-color: var(--primary-color); color: white; padding: 12px 25px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; display: inline-flex; align-items: center;"><i class="fas fa-arrow-right" style="margin-right: 8px;"></i>Suivant</button>
                        </div>
                    </div>
                  
                    <!-- Section 2 - Localisation -->
                    <div id="section2" class="form-section">
                        <h3 class="section-title">Localisation</h3>
                        <div class="form-group">
                            <label>Adresse</label>
                            <input type="text" th:field="*{adresse}" required placeholder="Entrez l'adresse complète">
                        </div>
                        <div class="form-group">
                            <label>Code postal</label>
                            <input type="text" th:field="*{codePostal}" required>
                        </div>
                        <div class="form-group">
                            <label>Ville</label>
                            <select th:field="*{ville}" required>
                                <option value="">Sélectionner</option>
                                <option th:each="ville : ${villes}" th:value="${ville.id}" th:text="${ville.nom}" th:selected="${hebergement.ville != null and hebergement.ville.id == ville.id}"></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Pays</label>
                            <select th:field="*{pays}" required>
                                <option value="">Sélectionner</option>
                                <option th:each="pays : ${pays}" th:value="${pays.id}" th:text="${pays.nom}" th:selected="${hebergement.pays != null and hebergement.pays.id == pays.id}"></option>
                            </select>
                        </div>
                        
                        <div class="form-navigation">
                            <button type="button" class="btn btn-prev" onclick="showSection(1)"><i class="fas fa-arrow-left" style="margin-right: 8px;"></i>Précédent</button>
                            <button type="button" class="btn btn-next" onclick="showSection(3)"><i class="fas fa-arrow-right" style="margin-right: 8px;"></i>Suivant</button>
                        </div>
                    </div>
                    
                    <!-- Section 3 - Disponibilité et capacité -->
                    <div id="section3" class="form-section">
                        <h3 class="section-title">Disponibilité et capacité</h3>
                        <div class="form-group">
                            <label>Capacité de l'hébergement</label>
                            <input type="number" th:field="*{capacite}" required min="1" placeholder="Nombre de personnes">
                        </div>
                        <div class="form-group">
                            <label>Tarif Type</label>
                            <select th:field="*{tarifType}" required>
                                <option value="">Sélectionner</option>
                                <option th:each="tarifType : ${tarifTypes}" th:value="${tarifType}" th:text="${#strings.capitalize(tarifType.name().toLowerCase().replace('_', ' '))}" th:selected="${hebergement.tarifType != null and hebergement.tarifType == tarifType}"></option>
                            </select>
                        </div>     
                        <div id="chambres-list"></div>
                        <button type="button" class="btn" style="background-color: #4a7aff; color: white; margin-top: 10px;" onclick="ajouterChambre()">
                          <i class="fas fa-plus"></i> Ajouter une chambre
                      </button>        
                      <div class="form-navigation">
                        <button type="button" class="btn btn-prev" onclick="showSection(1)"><i class="fas fa-arrow-left" style="margin-right: 8px;"></i>Précédent</button>
                        <button type="submit" class="btn btn-save"><i class="fas fa-save" style="margin-right: 8px;"></i>Enregistrer</button>
                    </div>    
                    </div>
    <script>
function ajouterChambre() {
    const chambresList = document.getElementById('chambres-list');
    const index = chambresList.children.length;
    const chambreDiv = document.createElement('div');
    chambreDiv.className = 'chambre-fields';
    chambreDiv.style = 'margin-bottom: 20px; border: 1px solid #e0e4ea; background: #f9fafd; padding: 18px 22px; border-radius: 10px; box-shadow: 0 1px 4px rgba(0,0,0,0.05); position: relative;';
    chambreDiv.innerHTML = `
    <div style="margin-bottom: 14px;">
        <label style="font-weight: 600; margin-bottom: 6px; display: block;">Type de chambre</label>
        <select name="chambres[${index}].type" required style="width: 100%; margin-bottom: 0; padding: 8px; border-radius: 6px; border: 1px solid #ccc;">
            <option value="">selectionner le type</option>
            <option value="Simple">Simple</option>
            <option value="Double">Double</option>
            <option value="Twin">Twin</option>
        </select>
    </div>
    <div style="margin-bottom: 14px;">
        <label style="font-weight: 600; margin-bottom: 6px; display: block;">Prix</label>
        <input type="number" name="chambres[${index}].prix" required min="0" step="0.01" placeholder="Prix" style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ccc;" />
    </div>
    <div style="margin-bottom: 14px;">
        <label style="font-weight: 600; margin-bottom: 6px; display: block;">Nombre de personnes</label>
        <input type="number" name="chambres[${index}].capacite" required min="1" placeholder="Nombre de personnes" style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ccc;" />
    </div>
    <div style="margin-bottom: 14px; display: flex; align-items: center; gap: 8px;">
        <input type="checkbox" name="chambres[${index}].disponible" id="disponible-${index}" style="width: 18px; height: 18px; accent-color: #4a7aff;" />
        <label for="disponible-${index}" style="margin: 0; font-weight: 600; font-size: 15px; color: #2c3e50;">
            Disponible
        </label>
    </div>
    <div style="margin-bottom: 0;">
        <button type="button" class="btn" style="background-color: #e74c3c; color: white; margin-left: 0; height: 38px; align-self: center;" onclick="this.closest('.chambre-fields').remove()">
            <i class="fas fa-trash"></i> Supprimer
        </button>
    </div>
`;
    chambresList.appendChild(chambreDiv);
}
document.addEventListener('DOMContentLoaded', function() {
    if (document.getElementById('chambres-list').children.length === 0) {
        ajouterChambre();
    }
});
</script>
        </div>
        </form>
      </div>
    </div>
  </div>
</div>
  <script>
        function previewImage(event) {
            const input = event.target;
            const preview = document.getElementById('imagePreview');
            const fileInputText = input.parentElement.querySelector('span');
            
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    preview.src = e.target.result;
                    preview.style.display = 'block';
                    fileInputText.innerHTML = `<i class="fas fa-check" style="margin-right: 8px; color: #2ecc71;"></i>${input.files[0].name}`;
                };
                reader.readAsDataURL(input.files[0]);
            } else {
                preview.style.display = 'none';
                fileInputText.innerHTML = `<i class="fas fa-upload" style="margin-right: 8px;"></i>Choisissez une image`;
            }
        }
        
        function showSection(sectionNumber) {
            console.log('Affichage de la section ' + sectionNumber);
            
            // Cacher toutes les sections
            document.querySelectorAll('.form-section').forEach(section => {
                section.classList.remove('active');
                section.style.display = 'none';
                console.log('Section masquée: ' + section.id);
            });
            
            // Afficher la section demandée
            const targetSection = document.getElementById('section' + sectionNumber);
            if (targetSection) {
                targetSection.classList.add('active');
                targetSection.style.display = 'block';
                console.log('Section ' + sectionNumber + ' affichée');
                
                // S'assurer que les boutons de navigation dans cette section sont visibles
                const navButtons = targetSection.querySelectorAll('.btn-next, .btn-prev, .btn-save');
                navButtons.forEach(button => {
                    button.style.display = 'inline-flex';
                    button.style.visibility = 'visible';
                    button.style.opacity = '1';
                    console.log('Bouton rendu visible: ' + button.textContent.trim());
                });
                
                // S'assurer que les conteneurs de navigation sont visibles
                const navContainers = targetSection.querySelectorAll('.form-navigation, .form-navigation-center');
                navContainers.forEach(nav => {
                    nav.style.display = 'flex';
                    nav.style.visibility = 'visible';
                    nav.style.opacity = '1';
                    console.log('Container de navigation rendu visible');
                });
            } else {
                console.error('Section ' + sectionNumber + ' non trouvée');
            }
            
            // Faire défiler vers le haut du formulaire
            document.querySelector('.form-container').scrollTop = 0;
        }
        
        // Fonction pour adapter l'interface en fonction de la taille de l'écran
        function adjustLayout() {
            const sidebar = document.querySelector('.dashboard__sidebar');
            const formContainer = document.querySelector('.form-container');
            const toggleBtn = document.getElementById('toggleSidebar');
            
            if (window.innerWidth <= 992) {
                toggleBtn.style.display = 'block';
            } else {
                toggleBtn.style.display = 'none';
            }
        }
        
        // Exécuter la fonction au chargement et au redimensionnement de la fenêtre
        window.addEventListener('load', function() {
            adjustLayout();
            
            // Vérifier si nous sommes en mode édition
            const isEditing = document.querySelector('input[type="hidden"][name="id"]') !== null;
            console.log('Mode édition: ' + isEditing);
            
            // Initialiser l'affichage des sections
            document.querySelectorAll('.form-section').forEach(section => {
                section.style.display = 'none';
                console.log('Section masquée: ' + section.id);
            });
            
            // Afficher la première section par défaut
            const firstSection = document.getElementById('section1');
            if (firstSection) {
                firstSection.classList.add('active');
                firstSection.style.display = 'block';
                console.log('Section affichée: ' + firstSection.id);
                
                // Forcer l'affichage des boutons de navigation dans la première section
                const navButtons = firstSection.querySelectorAll('.btn-next');
                navButtons.forEach(button => {
                    button.style.display = 'inline-flex';
                    button.style.visibility = 'visible';
                    button.style.opacity = '1';
                    button.style.backgroundColor = 'var(--primary-color)';
                    button.style.color = 'white';
                    button.style.padding = '12px 25px';
                    button.style.borderRadius = '8px';
                    button.style.border = 'none';
                    button.style.fontWeight = '600';
                    button.style.cursor = 'pointer';
                    button.style.margin = '5px';
                    console.log('Bouton Suivant rendu visible dans la section 1');
                });
                
                // Forcer l'affichage des conteneurs de navigation
                const navContainers = firstSection.querySelectorAll('.form-navigation-center');
                navContainers.forEach(nav => {
                    nav.style.display = 'flex';
                    nav.style.visibility = 'visible';
                    nav.style.opacity = '1';
                    nav.style.justifyContent = 'center';
                    nav.style.marginTop = '30px';
                    console.log('Container de navigation rendu visible dans la section 1');
                });
            }
            
            // S'assurer que tous les boutons sont visibles et stylisés correctement
            document.querySelectorAll('.btn-next, .btn-prev, .btn-save').forEach(button => {
                // Forcer l'affichage des boutons
                button.style.display = 'inline-flex';
                button.style.visibility = 'visible';
                button.style.opacity = '1';
                
                // Appliquer des styles attrayants
                button.style.backgroundColor = 'var(--primary-color)';
                button.style.color = 'white';
                button.style.padding = '12px 25px';
                button.style.borderRadius = '8px';
                button.style.border = 'none';
                button.style.fontWeight = '600';
                button.style.cursor = 'pointer';
                button.style.alignItems = 'center';
                button.style.margin = '5px';
                button.style.boxShadow = '0 2px 6px rgba(0, 86, 179, 0.15)';
                
                console.log('Style appliqué au bouton: ' + button.textContent.trim());
            });
            
            // S'assurer que les conteneurs de navigation sont visibles
            document.querySelectorAll('.form-navigation, .form-navigation-center').forEach(nav => {
                nav.style.display = 'flex';
                nav.style.visibility = 'visible';
                nav.style.opacity = '1';
                console.log('Style appliqué à la navigation');
            });
        });
        
        window.addEventListener('resize', adjustLayout);
        
        // Ajouter un écouteur d'événement pour le bouton de bascule de la barre latérale
        document.getElementById('toggleSidebar').addEventListener('click', function() {
            const sidebar = document.querySelector('.dashboard__sidebar');
            sidebar.classList.toggle('collapsed');
            adjustLayout();
        });
        
        // Fonction pour basculer l'affichage des sous-menus
        function toggleMenu(menuId) {
          // Récupérer le menu à afficher/masquer
          const menu = document.getElementById(menuId);
          
          // Fermer tous les autres menus
          const allMenus = document.querySelectorAll('[id$="-menu"]');
          allMenus.forEach(m => {
            if (m.id !== menuId) {
              m.style.display = 'none';
            }
          });
          
          // Basculer l'affichage du menu actuel
          if (menu.style.display === 'none' || menu.style.display === '') {
            menu.style.display = 'block';
          } else {
            menu.style.display = 'none';
          }
        }
        
        // Fonction pour basculer l'affichage des sous-menus avec le bouton
        function toggleSubmenu(button) {
          // Récupérer le conteneur du sous-menu (élément suivant après le bouton)
          const submenuContainer = button.closest('.sidebar__button').nextElementSibling;
          
          // Basculer l'affichage du sous-menu
          if (submenuContainer.style.display === 'none' || submenuContainer.style.display === '') {
            submenuContainer.style.display = 'block';
            // Ajouter la classe active au bouton
            button.classList.add('active');
            // Faire pivoter l'icône
            const icon = button.querySelector('.fa-chevron-down');
            if (icon) {
              icon.style.transform = 'rotate(180deg)';
            }
          } else {
            submenuContainer.style.display = 'none';
            // Retirer la classe active du bouton
            button.classList.remove('active');
            // Réinitialiser l'icône
            const icon = button.querySelector('.fa-chevron-down');
            if (icon) {
              icon.style.transform = 'rotate(0deg)';
            }
          }
        }
        
        // Script spécifique pour les superadmins en mode édition
        // Exécuter après un court délai pour s'assurer que tous les éléments sont chargés
        setTimeout(function() {
            // Vérifier si nous sommes en mode édition
            const isEditing = document.querySelector('input[type="hidden"][name="id"]') !== null;
            if (isEditing) {
                console.log('Mode édition détecté - Application des styles spécifiques');
                
                // Forcer l'affichage du bouton Suivant dans la section 1
                const nextButton = document.querySelector('#section1 .btn-next');
                if (nextButton) {
                    nextButton.style.display = 'inline-flex !important';
                    nextButton.style.visibility = 'visible !important';
                    nextButton.style.opacity = '1 !important';
                    nextButton.style.zIndex = '9999';
                    console.log('Bouton Suivant forcé visible dans la section 1');
                    
                    // Ajouter un événement de clic manuel
                    nextButton.addEventListener('click', function() {
                        console.log('Clic manuel sur le bouton Suivant');
                        showSection(2);
                    });
                }
                
                // Forcer l'affichage du conteneur de navigation
                const navContainer = document.querySelector('#section1 .form-navigation-center');
                if (navContainer) {
                    navContainer.style.display = 'flex !important';
                    navContainer.style.visibility = 'visible !important';
                    navContainer.style.opacity = '1 !important';
                    console.log('Container de navigation forcé visible dans la section 1');
                }
            }
            
            // Ouvrir automatiquement le menu actif
            const currentPath = window.location.pathname;
            const sidebarLinks = document.querySelectorAll('.sidebar-submenu a');
            
            sidebarLinks.forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    // Trouver le conteneur parent du sous-menu
                    const submenuContainer = link.closest('.sidebar-submenu-container');
                    if (submenuContainer) {
                        submenuContainer.style.display = 'block';
                        // Activer le bouton dropdown parent
                        const button = submenuContainer.previousElementSibling.querySelector('a');
                        if (button) {
                            button.classList.add('active');
                            // Faire pivoter l'icône
                            const icon = button.querySelector('.fa-chevron-down');
                            if (icon) {
                                icon.style.transform = 'rotate(180deg)';
                            }
                        }
                    }
                }
            });
        }, 500);
    </script>
  <script src="/SuperAdmin/js/sidebar.js"></script>
  
  <!-- Script pour le menu déroulant -->
  <script>
    function toggleSubmenu(element) {
      element.classList.toggle('active');
      const submenu = element.nextElementSibling;
      if (submenu.style.display === 'block') {
        submenu.style.display = 'none';
      } else {
        submenu.style.display = 'block';
      }
    }
  </script>
</body>
</html>
